The code concatenates the `dir` and user input `file_name`. Then in `resolve_path` it replaces whitespaces with the ‘-’ and sanitizes the path for path traversal vulnerability by first resolving it using `realpath` and makes sure that the resolved path still lies in the given `dir`. After returning to `print_file` it is passed to `fopen` and this way it prevents a path traversal attack.